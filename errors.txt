

Orchestrator: The deal is blocked from proceeding to drafting due to high-risk information gaps. Human review is required to approve the plan to gather the missing appraisal and borrower information.

AttributeError: This app has encountered an error. The original error message is redacted to prevent data leaks. Full error details have been recorded in the logs (if you're on Streamlit Cloud, click on 'Manage app' in the lower right of your app).
Traceback:
File "/mount/src/wbla/ui/app.py", line 1952, in <module>
    main()
    ~~~~^^
File "/mount/src/wbla/ui/app.py", line 1944, in main
    render_phase_drafting()
    ~~~~~~~~~~~~~~~~~~~~~^^
File "/mount/src/wbla/ui/app.py", line 1812, in render_phase_drafting
    st.warning(f"{flag.severity.value}: {flag.description}")
                                         ^^^^^^^^^^^^^^^^
File "/home/adminuser/venv/lib/python3.13/site-packages/pydantic/main.py", line 1026, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')



18:42:11] ğŸ Python dependencies were installed from /mount/src/wbla/requirements.txt using uv.

[18:42:11] ğŸ“¦ WARN: More than one requirements file detected in the repository. Available options: uv /mount/src/wbla/requirements.txt, poetry /mount/src/wbla/pyproject.toml. Used: uv with /mount/src/wbla/requirements.txt

Check if streamlit is installed

Streamlit is already installed

[18:42:13] ğŸ“¦ Processed dependencies!




Streaming LLM call failed for Writer: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'Resource exhausted. Please try again later. Please refer to https://cloud.google.com/vertex-ai/generative-ai/docs/error-code-429 for more details.', 'status': 'RESOURCE_EXHAUSTED'}}

Traceback (most recent call last):

  File "/mount/src/wbla/core/llm_client.py", line 385, in call_llm_streaming

    result_text = _call_gemini_streaming(

        prompt=prompt,

    ...<3 lines>...

        on_chunk=on_chunk,

    )

  File "/home/adminuser/venv/lib/python3.13/site-packages/tenacity/__init__.py", line 331, in wrapped_f

    return copy(f, *args, **kw)

  File "/home/adminuser/venv/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__

    do = self.iter(retry_state=retry_state)

  File "/home/adminuser/venv/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter

    result = action(retry_state)

  File "/home/adminuser/venv/lib/python3.13/site-packages/tenacity/__init__.py", line 393, in <lambda>

    self._add_action_func(lambda rs: rs.outcome.result())

                                     ~~~~~~~~~~~~~~~~~^^

  File "/usr/local/lib/python3.13/concurrent/futures/_base.py", line 449, in result

    return self.__get_result()

           ~~~~~~~~~~~~~~~~~^^

  File "/usr/local/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result

    raise self._exception

  File "/home/adminuser/venv/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__

    result = fn(*args, **kwargs)

  File "/mount/src/wbla/core/llm_client.py", line 340, in _call_gemini_streaming

    for chunk in client.models.generate_content_stream(

                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^

        model=model,

        ^^^^^^^^^^^^

        contents=prompt,

        ^^^^^^^^^^^^^^^^

        config=config,

        ^^^^^^^^^^^^^^

    ):

    ^

  File "/home/adminuser/venv/lib/python3.13/site-packages/google/genai/models.py", line 5651, in generate_content_stream

    for chunk in response:

                 ^^^^^^^^

  File "/home/adminuser/venv/lib/python3.13/site-packages/google/genai/models.py", line 4307, in _generate_content_stream

    for response in self._api_client.request_streamed(

                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^

        'post', path, request_dict, http_options

        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

    ):

    ^

  File "/home/adminuser/venv/lib/python3.13/site-packages/google/genai/_api_client.py", line 1403, in request_streamed

    session_response = self._request(http_request, http_options, stream=True)

  File "/home/adminuser/venv/lib/python3.13/site-packages/google/genai/_api_client.py", line 1222, in _request

    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]

           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/home/adminuser/venv/lib/python3.13/site-packages/tenacity/__init__.py", line 470, in __call__

    do = self.iter(retry_state=retry_state)

  File "/home/adminuser/venv/lib/python3.13/site-packages/tenacity/__init__.py", line 371, in iter

    result = action(retry_state)

  File "/home/adminuser/venv/lib/python3.13/site-packages/tenacity/__init__.py", line 413, in exc_check

    raise retry_exc.reraise()

          ~~~~~~~~~~~~~~~~~^^

  File "/home/adminuser/venv/lib/python3.13/site-packages/tenacity/__init__.py", line 184, in reraise

    raise self.last_attempt.result()

          ~~~~~~~~~~~~~~~~~~~~~~~~^^

  File "/usr/local/lib/python3.13/concurrent/futures/_base.py", line 449, in result

    return self.__get_result()

           ~~~~~~~~~~~~~~~~~^^

  File "/usr/local/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result

    raise self._exception

  File "/home/adminuser/venv/lib/python3.13/site-packages/tenacity/__init__.py", line 473, in __call__

    result = fn(*args, **kwargs)

  File "/home/adminuser/venv/lib/python3.13/site-packages/google/genai/_api_client.py", line 1187, in _request_once

    errors.APIError.raise_for_response(response)

    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^

  File "/home/adminuser/venv/lib/python3.13/site-packages/google/genai/errors.py", line 134, in raise_for_response

    cls.raise_error(response.status_code, response_json, response)

    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/home/adminuser/venv/lib/python3.13/site-packages/google/genai/errors.py", line 159, in raise_error

    raise ClientError(status_code, response_json, response)

google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'Resource exhausted. Please try again later. Please refer to https://cloud.google.com/vertex-ai/generative-ai/docs/error-code-429 for more details.', 'status': 'RESOURCE_EXHAUSTED'}}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Traceback (most recent call last) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  /home/adminuser/venv/lib/python3.13/site-packages/streamlit/runtime/scriptru  

  nner/exec_code.py:129 in exec_func_with_error_handling                        

                                                                                

  /home/adminuser/venv/lib/python3.13/site-packages/streamlit/runtime/scriptru  

  nner/script_runner.py:689 in code_to_exec                                     

                                                                                

  /mount/src/wbla/ui/app.py:1952 in <module>                                    

                                                                                

    1949                                                                        

    1950                                                                        

    1951 if __name__ == "__main__":                                             

  â± 1952 â”‚   main()                                                             

    1953                                                                        

                                                                                

  /mount/src/wbla/ui/app.py:1944 in main                                        

                                                                                

    1941 â”‚   elif phase == "COMPLIANCE":                                        

    1942 â”‚   â”‚   render_phase_compliance()                                      

    1943 â”‚   elif phase == "DRAFTING":                                          

  â± 1944 â”‚   â”‚   render_phase_drafting()                                        

    1945 â”‚   elif phase == "COMPLETE":                                          

    1946 â”‚   â”‚   render_phase_complete()                                        

    1947 â”‚   else:                                                              

                                                                                

  /mount/src/wbla/ui/app.py:1812 in render_phase_drafting                       

                                                                                

    1809 â”‚   â”‚   â”‚   â”‚   st.info(f"Orchestrator: {routing.message_to_human}")   

    1810 â”‚   â”‚   â”‚   if routing and routing.flags:                              

    1811 â”‚   â”‚   â”‚   â”‚   for flag in routing.flags:                             

  â± 1812 â”‚   â”‚   â”‚   â”‚   â”‚   st.warning(f"{flag.severity.value}: {flag.descrip  

    1813 â”‚   â”‚   â”‚   can_export = True                                          

    1814 â”‚   â”‚   â”‚   if routing and not routing.can_proceed:                    

    1815 â”‚   â”‚   â”‚   â”‚   st.warning("Orchestrator recommends review before exp  

                                                                                

  /home/adminuser/venv/lib/python3.13/site-packages/pydantic/main.py:1026 in    

  __getattr__                                                                   

                                                                                

    1023 â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   return super().__getattribute__(item)  # Rais  

    1024 â”‚   â”‚   â”‚   â”‚   â”‚   else:                                              

    1025 â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   # this is the current error                    

  â± 1026 â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   raise AttributeError(f'{type(self).__name__!r  

    1027 â”‚   â”‚                                                                  

    1028 â”‚   â”‚   def __setattr__(self, name: str, value: Any) -> None:          

    1029 â”‚   â”‚   â”‚   if (setattr_handler := self.__pydantic_setattr_handlers__  

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

AttributeError: 'RiskFlag' object has no attribute 'description'
